<local:FavouritesPageBase
    x:Class="_1809_UWP.Pages.FavouritesPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:models="using:WikiViewer.Core.Models"
    xmlns:local="using:WikiViewer.Shared.Uwp.Pages"
    xmlns:helpers="using:WikiViewer.Shared.Uwp.Helpers"
    Background="Transparent">
    <Page.Resources>
        <Storyboard x:Name="FadeInAnimation">
            <DoubleAnimation Storyboard.TargetName="LoadingOverlayControl" Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:0.250" EnableDependentAnimation="True"/>
        </Storyboard>
        <Storyboard x:Name="FadeOutAnimation">
            <DoubleAnimation Storyboard.TargetName="LoadingOverlayControl" Storyboard.TargetProperty="Opacity" From="1" To="0" Duration="0:0:0.350" EnableDependentAnimation="True"/>
        </Storyboard>
    </Page.Resources>
    <Grid>

        <ScrollViewer x:Name="GridViewScrollViewerControl" HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Visible">
            <GridView x:Name="FavouritesGridViewControl" Padding="24,52,24,48" IsItemClickEnabled="False" SelectionMode="Multiple" SelectionChanged="FavouritesGridView_SelectionChanged" HorizontalAlignment="Center" ContainerContentChanging="FavouritesControl_ContainerContentChanging">
                <GridView.ItemContainerStyle>
                    <Style TargetType="GridViewItem">
                        <Setter Property="Margin" Value="8"/>
                    </Style>
                </GridView.ItemContainerStyle>
                <GridView.ItemTemplate>
                    <DataTemplate x:DataType="models:FavouriteItem">
                        <Grid Width="300"
                              BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                              BorderThickness="1"
                              Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                              CornerRadius="{ThemeResource ControlCornerRadius}"
                              Visibility="{x:Bind IsVisible, Converter={StaticResource GlobalBoolToVisibility}, Mode=OneWay}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="180"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Canvas x:Name="Viewport" Grid.Row="0" Width="300" Height="180">
                                <Image x:Name="LeadImage"
           helpers:NativeAnimatedImageLoader.SourceUri="{x:Bind ImageUrl, Mode=OneWay}"/>
                            </Canvas>

                            <StackPanel Grid.Row="1" Padding="12" Spacing="4" Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}">
                                <TextBlock Text="{x:Bind DisplayTitle}" Style="{ThemeResource SubtitleTextBlockStyle}" TextWrapping="Wrap"/>
                                <TextBlock Text="{x:Bind WikiName}" Style="{ThemeResource CaptionTextBlockStyle}" Foreground="{ThemeResource SystemAccentColor}" FontWeight="SemiBold"/>
                                <Grid Margin="0,4,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Button Grid.Column="0" Content="Article" Click="ArticleButton_Click" DataContext="{x:Bind}" Visibility="{x:Bind IsArticleAvailable, Converter={StaticResource GlobalBoolToVisibility}}"/>
                                    <Button Grid.Column="1" Content="Talk" Margin="8,0,0,0" Click="TalkButton_Click" DataContext="{x:Bind}" Visibility="{x:Bind IsTalkAvailable, Converter={StaticResource GlobalBoolToVisibility}}"/>
                                </Grid>
                            </StackPanel>
                        </Grid>
                    </DataTemplate>
                </GridView.ItemTemplate>
            </GridView>
        </ScrollViewer>
        <ScrollViewer x:Name="ListViewScrollViewerControl" HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Visible" Visibility="Collapsed">
            <ListView x:Name="FavouritesListViewControl" Padding="12,52,12,48" SelectionMode="Multiple" SelectionChanged="FavouritesListView_SelectionChanged" ContainerContentChanging="FavouritesControl_ContainerContentChanging">
                <ListView.ItemContainerStyle>
                    <Style TargetType="ListViewItem">
                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                    </Style>
                </ListView.ItemContainerStyle>
                <ListView.ItemTemplate>
                    <DataTemplate x:DataType="models:FavouriteItem">
                        <Grid Height="80" Padding="8" Visibility="{x:Bind IsVisible, Converter={StaticResource GlobalBoolToVisibility}, Mode=OneWay}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="80"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <Canvas x:Name="ThumbViewport" Grid.Column="0" Width="64" Height="64" VerticalAlignment="Center">
                                <Image x:Name="ThumbImage"
           helpers:NativeAnimatedImageLoader.SourceUri="{x:Bind ImageUrl, Mode=OneWay}"/>
                            </Canvas>

                            <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="12,0">
                                <TextBlock Text="{x:Bind DisplayTitle}" Style="{ThemeResource BodyStrongTextBlockStyle}" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis"/>
                                <TextBlock Text="{x:Bind WikiName}" Style="{ThemeResource CaptionTextBlockStyle}" Opacity="0.7"/>
                            </StackPanel>

                            <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                                <Button Content="Article" Click="ArticleButton_Click" DataContext="{x:Bind}" Visibility="{x:Bind IsArticleAvailable, Converter={StaticResource GlobalBoolToVisibility}}"/>
                                <Button Content="Talk" Click="TalkButton_Click" DataContext="{x:Bind}" Visibility="{x:Bind IsTalkAvailable, Converter={StaticResource GlobalBoolToVisibility}}"/>
                            </StackPanel>
                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </ScrollViewer>
        <TextBlock x:Name="NoFavouritesTextBlockControl" Text="You haven't added any Favourites yet." Style="{ThemeResource SubtitleTextBlockStyle}" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Collapsed"/>
        <CommandBar Background="{ThemeResource PageTitleBarAcrylicBrush}"
            DefaultLabelPosition="Right"
            IsDynamicOverflowEnabled="True">
            <CommandBar.Content>
                <TextBlock Text="Favourites"
                           Style="{StaticResource PageTitleBarTextStyle}"
                           VerticalAlignment="Center"
                           Margin="12,4" />
            </CommandBar.Content>

            <AppBarElementContainer>
                <AutoSuggestBox x:Name="SearchBoxControl"
                        Width="240"
                        PlaceholderText="Search favourites..."
                        TextChanged="SearchBoxControl_TextChanged"
                        Margin="0,7,0,0"/>
            </AppBarElementContainer>
        </CommandBar>
        <CommandBar x:Name="BottomCommandBarControl" VerticalAlignment="Bottom" Background="{StaticResource PageTitleBarAcrylicBrush}" Margin="0,0,0,0">
            <AppBarElementContainer>
                <ComboBox x:Name="WikiFilterComboBoxControl"
                          Width="140"
                          SelectionChanged="WikiFilterComboBox_SelectionChanged"
                          Margin="0,6,0,0"
                          Height="36"                          SelectedItem="0">
                    <ComboBoxItem Content="All Wikis" Tag=""/>
                </ComboBox>
            </AppBarElementContainer>

            <AppBarElementContainer>
                <ComboBox x:Name="SortComboBoxControl"
                          Width="140"
                          SelectionChanged="SortComboBox_SelectionChanged"
                          Margin="4,6,2,0"
                          Height="36"
                          SelectedItem="0">
                    <ComboBoxItem Content="Title (A–Z)" Tag="TitleAsc"/>
                    <ComboBoxItem Content="Title (Z–A)" Tag="TitleDesc"/>
                    <ComboBoxItem Content="Wiki (A–Z)" Tag="WikiAsc"/>
                    <ComboBoxItem Content="Wiki (Z–A)" Tag="WikiDesc"/>
                </ComboBox>
            </AppBarElementContainer>
            
            <AppBarButton x:Name="DeleteButtonControl" Icon="Delete" Label="Delete" Click="DeleteButton_Click" Visibility="Collapsed"/>
            <AppBarButton x:Name="ViewToggleButtonControl" Icon="List" Label="List View" Click="ViewToggleButton_Click"/>
        </CommandBar>
        <Grid x:Name="LoadingOverlayControl" Opacity="0" IsHitTestVisible="False" Background="{StaticResource PageTitleBarAcrylicBrush}">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="12">
                <ProgressRing IsActive="True" Width="60" Height="60"/>
            </StackPanel>
        </Grid>
    </Grid>
</local:FavouritesPageBase>
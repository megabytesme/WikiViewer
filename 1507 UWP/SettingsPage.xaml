<local:SettingsPageBase
    x:Class="_1507_UWP.Pages.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:WikiViewer.Shared.Uwp.Pages"
    xmlns:models="using:WikiViewer.Core.Models"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel MaxWidth="600" HorizontalAlignment="Center" Margin="8,0,8,0">
                <Border BorderThickness="1" BorderBrush="{ThemeResource SystemControlForegroundBaseLowBrush}" Padding="16" Margin="0,16,0,16">
                    <StackPanel>
                        <TextBlock Text="Manage Wikis" Style="{ThemeResource SubtitleTextBlockStyle}" Margin="0,0,0,8"/>
                        <TextBlock Text="Add, remove, or edit the MediaWiki sites this app connects to." TextWrapping="Wrap" Opacity="0.7" Margin="0,0,0,12"/>
                        <ScrollViewer  MaxHeight="300" >
                            <ListView x:Name="WikiListView" IsItemClickEnabled="True" ItemClick="WikiListView_ItemClick" SelectionMode="None">
                                <ListView.ItemTemplate>
                                    <DataTemplate x:DataType="models:WikiInstance">
                                        <StackPanel Orientation="Horizontal" Padding="8,4">
                                            <Image Source="{x:Bind IconUrl, Converter={StaticResource StringToBitmapImageConverter}, Mode=OneWay}"
                                                   Width="24" Height="24"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,12,0"/>
                                            <TextBlock Text="{x:Bind Name}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                        </ScrollViewer>
                        <Button Content="Add a New Wiki" HorizontalAlignment="Stretch" Margin="0,12,0,0" Click="AddWikiButton_Click"/>
                    </StackPanel>
                </Border>

                <Border BorderThickness="1" BorderBrush="{ThemeResource SystemControlForegroundBaseLowBrush}" Padding="16" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="Connection" Style="{ThemeResource SubtitleTextBlockStyle}" Margin="0,0,0,12"/>
                        <ComboBox x:Name="DefaultConnectionMethodComboBox"
                                  Header="Default connection method for new wikis"
                                  SelectionChanged="DefaultConnectionMethodComboBox_SelectionChanged"
                                  Margin="0,0,0,12"/>

                        <ComboBox x:Name="ConcurrencyComboBox"
                                  Header="Concurrent downloads per page"
                                  SelectionChanged="ConcurrencyComboBox_SelectionChanged"
                                  Margin="0,12,0,0"/>
                        <TextBlock x:Name="ConcurrencyDescriptionText"
                                   Margin="0,4,0,0"
                                   Style="{ThemeResource CaptionTextBlockStyle}"
                                   TextWrapping="Wrap"
                                   Opacity="0.7"/>
                    </StackPanel>
                </Border>

                <Border BorderThickness="1" BorderBrush="{ThemeResource SystemControlForegroundBaseLowBrush}" Padding="16" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="Storage" Style="{ThemeResource SubtitleTextBlockStyle}" Margin="0,0,0,12"/>
                        <ToggleSwitch x:Name="CachingToggle"
                                      Header="Enable Offline Reading (Caching)"
                                      Toggled="CachingToggle_Toggled"
                                      Margin="0,0,0,12"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock x:Name="CacheSizeText" Text="Calculating..." VerticalAlignment="Center" Style="{ThemeResource BodyTextBlockStyle}" Opacity="0.7"/>
                            <Button x:Name="ClearCacheButton" Grid.Column="1" Content="Clear Cache" Click="ClearCacheButton_Click" VerticalAlignment="Center"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <Border BorderThickness="1" BorderBrush="{ThemeResource SystemControlForegroundBaseLowBrush}" Padding="16" Margin="0,0,0,16">
                    <StackPanel Margin="12">
                        <TextBlock Text="Appearance" Style="{ThemeResource SubtitleTextBlockStyle}"/>
                        <TextBlock Text="Customize the look and feel of articles. After editing, use the refresh button on an article page to see your changes." TextWrapping="Wrap" Opacity="0.7"/>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="12" >
                            <Button Content="Edit Custom Theme (CSS)" Click="EditThemeButton_Click" Margin="0,0,10,0"/>
                            <Button Content="Reset to Default Theme" Click="ResetThemeButton_Click"/>
                        </StackPanel>
                        <Grid Margin="0,12,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0"
                                       Text="Show CSS Refresh button"
                                       VerticalAlignment="Center"
                                       Style="{ThemeResource BodyTextBlockStyle}"/>
                            <ToggleSwitch x:Name="ShowCssRefreshToggle"
                                          Grid.Column="1"
                                          Toggled="ShowCssRefreshButtonToggle_Toggled"
                                          VerticalAlignment="Center"
                                          HorizontalAlignment="Right"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <Border BorderThickness="1" BorderBrush="{ThemeResource SystemControlForegroundBaseLowBrush}" Padding="16" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="About" Style="{ThemeResource SubtitleTextBlockStyle}" Margin="0,0,0,12"/>
                        <StackPanel Orientation="Horizontal">
                            <Button Content="About This App" Click="AboutButton_Click" Margin="0,0,12,0"/>
                            <Button Content="Disclaimer" Click="DisclaimerButton_Click"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</local:SettingsPageBase>